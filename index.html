<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="ChordMaster - Gestor profesional de letras y acordes musicales">
    <title>ChordMaster - Letras y Acordes</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mammoth/1.6.0/mammoth.browser.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf-lib/1.17.1/pdf-lib.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
            line-height: 1.6;
        }

        /* ... (el resto del CSS se mantiene igual) ... */
    </style>
</head>
<body>
    <!-- Contenido se mantiene igual -->
    <div class="status-indicator" id="statusIndicator">
        <span id="connectionStatus">🟢 Online</span>
    </div>

    <!-- ... resto del HTML se mantiene igual ... -->

    <script>
        // Estado global de la aplicación
        const appState = {
            currentSong: null,
            currentKey: 'C',
            songs: [],
            folders: [],
            isOnline: navigator.onLine
        };

        // Sistema de acordes
        const chordSystem = {
            notes: ['C', 'C#', 'D', 'D#', 'E', 'F', 'F#', 'G', 'G#', 'A', 'A#', 'B'],
            notesFlat: ['C', 'Db', 'D', 'Eb', 'E', 'F', 'Gb', 'G', 'Ab', 'A', 'Bb', 'B'],
            
            transpose(chord, semitones) {
                if (!chord || typeof chord !== 'string') return chord;
                
                // Detectar si es acorde con bemol
                const isFlat = chord.includes('b');
                const notes = isFlat ? this.notesFlat : this.notes;
                
                // Extraer la nota base del acorde
                let baseNote = chord.charAt(0);
                let modifier = '';
                let suffix = '';
                
                if (chord.length > 1) {
                    if (chord.charAt(1) === '#' || chord.charAt(1) === 'b') {
                        baseNote += chord.charAt(1);
                        suffix = chord.substring(2);
                    } else {
                        suffix = chord.substring(1);
                    }
                }
                
                // Encontrar la posición actual
                const currentIndex = notes.indexOf(baseNote);
                if (currentIndex === -1) return chord;
                
                // Calcular nueva posición
                let newIndex = (currentIndex + semitones) % 12;
                if (newIndex < 0) newIndex += 12;
                
                return notes[newIndex] + suffix;
            }
        };

        // Inicialización
        document.addEventListener('DOMContentLoaded', function() {
            loadData();
            updateConnectionStatus();
            setupFileUpload();
            setupKeyboardShortcuts();
            setupOfflineSupport();
            startSyncSystem();
        });

        // ... resto del JavaScript se mantiene igual ...

        // Función faltante que mencionaste
        function showSyncStatus(message, type) {
            const statusDiv = document.getElementById('syncStatus');
            statusDiv.textContent = message;
            statusDiv.className = `sync-status sync-${type}`;
            
            setTimeout(() => {
                statusDiv.textContent = '';
                statusDiv.className = 'sync-status';
            }, 3000);
        }

        function setupOfflineSupport() {
            // Implementación básica de soporte offline
            if (!navigator.onLine) {
                showSyncStatus('Modo offline activado. Los cambios se guardarán localmente.', 'warning');
            }
        }

        function startSyncSystem() {
            // Sistema de sincronización básico
            setInterval(() => {
                if (navigator.onLine) {
                    // Aquí iría la lógica de sincronización con el servidor
                    console.log('Sincronizando datos...');
                }
            }, 30000); // Sincroniza cada 30 segundos
        }
    </script>
</body>
</html>
